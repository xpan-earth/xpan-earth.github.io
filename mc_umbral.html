<!DOCTYPE html>
<html lang="es" data-xpan>
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="color-scheme" content="light dark"/>
  <title>xpan — umbral</title>

  <style>
    /* ===== tokens post-tech / defense-ops ===== */
    :root{
      --bg:#0C0D0F; --fg:#E0E3E6; --fg-dim:#AEB4BA; --accent:#1860FF;
      --line:#2A2E31; --b1:1px solid var(--line);
      --pad:clamp(16px,4vw,48px); --header-h:64px;
      --ease:cubic-bezier(.22,.61,.36,1);
      --stroke-dark:#FFFFFF; --stroke-light:#000000;
    }
    @media (prefers-color-scheme:light){
      :root{ --bg:#FFFFFF; --fg:#0E1113; --fg-dim:#4A5158; --line:#DDE3EA }
    }

    /* ===== base ===== */
    *,*::before,*::after{box-sizing:border-box}
    html,body{height:100%}
    html,body{
      margin:0; background:var(--bg); color:var(--fg);
      font-family:-apple-system,BlinkMacSystemFont,"Inter","Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; overflow:hidden;
      cursor:crosshair;
    }
    a{color:var(--accent); text-decoration:none; border-bottom:1px solid transparent; transition:border-color .15s var(--ease)}
    a:hover{border-bottom-color:var(--accent)}

    /* ===== header + selector idioma (normalizado) ===== */
    header{
      position:fixed; top:12px; left:var(--pad); right:var(--pad);
      height:var(--header-h); z-index:10; display:flex; align-items:center; justify-content:space-between;
    }
    header img{ width:50px; height:auto; mix-blend-mode:difference; filter:invert(1) saturate(100%) }
    @media (prefers-color-scheme:light){ header img{ mix-blend-mode:normal; filter:none } }

    .language-selector{
      position:fixed; top:12px; right:var(--pad); z-index:20;
      display:flex; gap:8px; text-transform:lowercase;
    }
    .language-selector button{
      appearance:none; background:transparent; border:var(--b1); border-radius:0;
      padding:.35rem .6rem; cursor:pointer; color:var(--fg-dim);
      font:600 .9rem/1 "Inter",system-ui; letter-spacing:.2px;
      transition:color .15s var(--ease), border-color .15s var(--ease), background-color .15s var(--ease);
    }
    .language-selector button:hover{ color:var(--fg) }
    .language-selector button.active{ color:var(--fg); border-color:var(--accent); background:rgba(24,96,255,.06) }

    /* ===== líneas verticales ===== */
    .line{
      position:absolute; top:-10vh; width:1px; height:120vh; z-index:1;
      opacity:.06; pointer-events:none;
      background: currentColor;
      animation:floatLine 14s infinite var(--ease);
      transition: transform .3s var(--ease);
    }
    @media (prefers-color-scheme:dark){ .line{ color:var(--stroke-dark) } }
    @media (prefers-color-scheme:light){ .line{ color:var(--stroke-light) } }
    @keyframes floatLine{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(10px)} }

    /* ===== contenedor central ===== */
    .container{
      position:absolute; inset:50% auto auto 50%;
      transform:translate(-50%,-50%); text-align:center; z-index:5; width:90vw; max-width:800px;
    }
    .phrase{ font:400 1.05rem/1.6 "Inter",system-ui; text-transform:lowercase; opacity:0; transition:opacity 1.8s var(--ease) }
    .visible{ opacity:1 }

    /* ===== multilenguaje ===== */
    .lang{ display:none }
    .lang.active{ display:block }
  </style>
</head>
<body>

  <header>
    <a href="https://xpan.earth" aria-label="xpan"><img src="./xpan.svg" alt="xpan" fetchpriority="high" decoding="async"></a>
  </header>

  <nav class="language-selector" aria-label="selector de idioma" role="tablist">
    <button type="button" onclick="setLang('es')" class="active" aria-pressed="true" role="tab">es</button>
    <button type="button" onclick="setLang('en')" aria-pressed="false" role="tab">en</button>
    <button type="button" onclick="setLang('fr')" aria-pressed="false" role="tab">fr</button>
    <button type="button" onclick="setLang('jp')" aria-pressed="false" role="tab">jp</button>
  </nav>

  <!-- líneas verticales (generadas en runtime) -->

  <!-- contenedor de frases (multilenguaje) -->
  <div class="container">
    <div class="lang lang-es active">
      <div id="text_es" class="phrase"></div>
    </div>
    <div class="lang lang-en">
      <div id="text_en" class="phrase"></div>
    </div>
    <div class="lang lang-fr">
      <div id="text_fr" class="phrase"></div>
    </div>
    <div class="lang lang-jp">
      <div id="text_jp" class="phrase"></div>
    </div>
  </div>

  <script>
  /* ===== selector multilenguaje (normalizado) ===== */
  function setLang(lang){
    localStorage.setItem('lang', lang);
    document.querySelectorAll('.lang').forEach(n=> n.classList.remove('active'));
    document.querySelector(`.lang-${lang}`)?.classList.add('active');
    document.querySelectorAll('.language-selector button').forEach(btn=>{
      const on = btn.textContent===lang;
      btn.classList.toggle('active', on);
      btn.setAttribute('aria-pressed', on ? 'true' : 'false');
    });
    document.documentElement.setAttribute('lang', lang);
  }
  setLang(localStorage.getItem('lang') || (navigator.language.slice(0,2) || 'es'));

  /* ===== líneas verticales ===== */
  (function(){
    const total = 14, reduce = matchMedia('(prefers-reduced-motion: reduce)').matches;
    const lines = [];
    for(let i=0;i<total;i++){
      const l=document.createElement('div');
      l.className='line';
      l.style.left = `${(i/total)*100}vw`;
      if(reduce){ l.style.animation='none'; }
      document.body.appendChild(l);
      lines.push(l);
    }
    let rafId=null;
    const move = (t)=>{
      lines.forEach((line,i)=>{
        const y = Math.sin((t/3000)+i)*10;
        line.style.transform = `translateY(${y}px)`;
      });
      rafId = requestAnimationFrame(move);
    };
    if(!reduce){ rafId = requestAnimationFrame(move); }
    // parallax leve con puntero
    window.addEventListener('mousemove', e=>{
      const center = innerWidth/2, offset = (e.clientX-center)/center;
      lines.forEach((line,i)=>{
        const strength = (i - total/2) / (total/2);
        line.style.transform += ` translateX(${strength*offset*10}px)`;
      });
    }, {passive:true});
    document.addEventListener('visibilitychange',()=>{ if(document.hidden && rafId){ cancelAnimationFrame(rafId); rafId=null; } else if(!document.hidden && !rafId && !reduce){ rafId=requestAnimationFrame(move); } });
  })();

  /* ===== frases multilenguaje ===== */
  const FR = {
    es: [
      'el umbral es una condición, no una forma',
      'nada atraviesa intacto',
      'todo cruce implica pérdida',
      'la entrada no es reversible',
      'el umbral tensiona lo que aún no sucede',
      'todo inicio real es un corte',
      'el borde transforma',
      'si hay paso, hay mutación'
    ],
    en: [
      'a threshold is a condition, not a form',
      'nothing crosses intact',
      'every crossing entails loss',
      'entry is not reversible',
      'the threshold tensions what is yet to happen',
      'every real beginning is a cut',
      'the edge transforms',
      'where there is passage, there is mutation'
    ],
    fr: [
      "le seuil est une condition, pas une forme",
      "rien ne traverse indemne",
      "tout franchissement implique une perte",
      "l'entrée n'est pas réversible",
      "le seuil tend ce qui n'advient pas encore",
      "tout véritable commencement est une coupe",
      "la lisière transforme",
      "s'il y a passage, il y a mutation"
    ],
    jp: [
      "閾はかたちではなく条件である",
      "無傷で横断されるものはない",
      "あらゆる横断は喪失を伴う",
      "入口は可逆ではない",
      "閾は未だ起こらぬものを緊張させる",
      "真の始まりはつねに切断である",
      "縁は変容をもたらす",
      "通過があれば変異がある"
    ]
  };

  (function cycle(){
    const lang = localStorage.getItem('lang') || 'es';
    const el = document.getElementById(`text_${lang}`) || document.getElementById('text_es');
    const arr = FR[lang] || FR.es;
    let idx = 0;
    function show(){
      el.classList.remove('visible');
      setTimeout(()=>{
        el.textContent = arr[idx];
        el.classList.add('visible');
        idx = (idx+1) % arr.length;
      }, 1800);
    }
    show();
    setInterval(show, 6000);
  })();
  </script>
</body>
</html>
